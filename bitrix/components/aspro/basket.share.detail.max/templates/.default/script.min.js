void 0===window.JCBasketShareDetail&&(window.JCBasketShareDetail=function(t,e){this.timerCopy=!1,this.params={},this.result={},this.$block=!1,this.$onoffHead=!1,this.$btnAdd2Basket=!1,this.$btnReplaceBasket=!1,this.$form=!1,this.$error=!1,"object"==typeof e&&(this.result=e),"object"==typeof t&&(this.params=t,this.init())},window.JCBasketShareDetail.prototype={init:function(){this.$block=$("#basket-share-detail"),this.$block.length&&(this.$form=this.$block.find("form"),this.$onoffHead=this.$block.find(".basket-share-detail__head__onoff"),this.$btnAdd2Basket=this.$block.find(".basket-share-detail__foot__btn--add2basket"),this.$btnReplaceBasket=this.$block.find(".basket-share-detail__foot__btn--replacebasket"),this.$error=this.$block.find(".basket-share-detail__error__text")),this.updateActionButtons(),this.bindEvents()},sendForm:function(s,i){var t,n,e=this.result.AJAX_URL;e&&(t=this.$form.serialize(),n=this,$.ajax({url:e,type:"POST",data:t,dataType:s?"json":"text",beforeSend:function(){n.$block.addClass("sending")},success:function(t){var e;s||(n.$block.wrap("<div></div>"),(e=n.$block.parent()).html(t),n.$block=e.find(".basket-share-detail"),e.find(">div").unwrap("<div></div>"),"function"==typeof setStatusButton&&setStatusButton()),"function"==typeof i&&i(t)},error:function(t,e,s){n.$block.addClass("basket-share-detail--haserror"),n.$error.text(BX.message.CD_T_ERROR_REQUEST+" "+s+" ("+t.status+")")},complete:function(){n.$block.removeClass("sending"),n.$block.find(".loadings").removeClass("loadings")}}))},updateActionButtons:function(){var t;this.$form.length&&(t=this.$form.find(".basket-share-detail__item__check input[type=checkbox]:checked").length,this.$btnAdd2Basket.length&&this.$btnAdd2Basket.prop("disabled",0==t),this.$btnReplaceBasket.length&&this.$btnReplaceBasket.prop("disabled",0==t))},bindEvents:function(){var s=this;this.$block.length&&this.$form.length&&(this.$form.submit(function(t){t.preventDefault()}),this.$form.find(".basket-share-detail__item__check input[type=checkbox]").change(function(){s.updateActionButtons()}),this.$onoffHead.length&&this.$onoffHead.click(function(t){var e;t.preventDefault(),s.$block.hasClass("sending")||$(this).hasClass("loadings")||($(this).addClass("loadings"),e=s.$onoffHead.find("input[type=checkbox]").prop("checked"),s.$form.find("input[name=ORIGINAL]").val(e?"Y":"N"),s.sendForm(!1))}),this.$btnAdd2Basket.length&&this.$btnAdd2Basket.click(function(t){t.preventDefault(),s.$block.hasClass("sending")||$(this).hasClass("loadings")||($(this).addClass("loadings"),s.$form.append('<input type="hidden" name="ACTION" value="ADD2BASKET" />'),s.sendForm(!0,function(t){!t.ERRORS.length&&t.BASKET_PAGE_URL&&(location.href=t.BASKET_PAGE_URL)}))}),this.$btnReplaceBasket.length&&this.$btnReplaceBasket.click(function(t){t.preventDefault(),s.$block.hasClass("sending")||$(this).hasClass("loadings")||($(this).addClass("loadings"),s.$form.append('<input type="hidden" name="ACTION" value="REPLACEBASKET" />'),s.sendForm(!0,function(t){!t.ERRORS.length&&t.BASKET_PAGE_URL&&(location.href=t.BASKET_PAGE_URL)}))}))},onResizeHandler:function(){"function"==typeof CheckPopupTop&&CheckPopupTop()}});