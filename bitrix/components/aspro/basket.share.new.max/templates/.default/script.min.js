void 0===window.JCBasketShareNew&&(window.JCBasketShareNew=function(t,i,o){this.rand=t,this.timerCopy=!1,this.params={},this.result={},this.$popup=!1,this.$block=!1,this.$copy=!1,this.$inputUrl=!1,this.$error=!1,"object"==typeof o&&(this.result=o),"object"==typeof i&&(this.params=i,this.init())},window.JCBasketShareNew.prototype={init:function(){var t,i;this.$block=$("#basket-share-new-"+this.rand),this.$block.length&&(this.$popup=this.$block.closest(".popup"),this.bPopup=0<this.$popup.length,this.$copy=this.$block.find(".basket-share-new-copy-url"),this.$inputUrl=this.$block.find(".basket-share-new-url input"),this.$error=this.$block.find(".basket-share-new-error-text"),t=this,i=setInterval(function(){t.$block.height()&&(clearInterval(i),"function"==typeof CheckPopupTop&&CheckPopupTop(),t.onResizeHandler())},100)),this.bindEvents()},bindEvents:function(){var o=this;this.$block.length&&this.bPopup&&$(window).resize(function(){o.onResizeHandler()}),$(document).ready(function(){o.$copy.length&&o.waitClipboardInit(100,function(){var i=o.$copy.data("clipboard-text");clipboard=new Clipboard(o.$copy[0]),clipboard.on("success",function(t){o.$inputUrl&&(o.$inputUrl.val(BX.message("BSN_T_URL_COPIED_HINT")),o.timerCopy&&(clearTimeout(o.timerCopy),o.timerCopy=!1),o.timerCopy=setTimeout(function(){o.$inputUrl.val(i)},2e3)),t.clearSelection()}),clipboard.on("error",function(t){alert(BX.message("BSN_T_URL_COPY_ERROR_HINT"))})})})},onResizeHandler:function(){"function"==typeof CheckPopupTop&&CheckPopupTop(),this.bPopup&&window.matchMedia("(max-width:767px)").matches},waitClipboardInit:function(t,i){var o=this;"function"!=typeof Clipboard||"function"!=typeof Clipboard.prototype.on?setTimeout(function(){o.waitClipboardInit(t,i)},t):"function"==typeof i&&i()}});